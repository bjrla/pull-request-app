@if (pullRequests.length > 0) {
<div class="summary">
  <div class="summary-header">
    <h2>Summary</h2>
    <div class="summary-controls">
      <label class="draft-toggle">
        <input
          type="checkbox"
          [checked]="showDrafts"
          (change)="onToggleDrafts()"
        />
        <span class="toggle-text">Show drafts</span>
      </label>
      <button (click)="onRefresh()" [disabled]="isLoading" class="refresh-btn">
        {{ isLoading ? "Loading..." : "Refresh" }}
      </button>
    </div>
  </div>
  <div class="project-counts">
    @for (item of projectSummary; track item.project) {
    <div
      class="project-count"
      [class.selected]="isRepositorySelected(item.project)"
      [class.disabled]="!hasActivePRs(item.project)"
      [class.has-suggestions]="hasCreatePRSuggestions(item.project)"
      (click)="onFilterByRepository(item.project)"
    >
      <div class="repo-indicator">
        <div class="repo-header">
          <span class="project-name">{{ item.project }}</span>
        </div>
        <div
          class="repo-underline"
          [style.background-color]="getRepositoryColor(item.project)"
        ></div>
      </div>
      <span class="count"
        >{{ item.count }} PR{{ item.count !== 1 ? "s" : "" }}</span
      >

      <!-- PR Suggestions Section -->
      @if (hasCreatePRSuggestions(item.project)) {
      <div class="pr-suggestions">
        <div class="suggestions-header">You updated:</div>
        @for (suggestion of getSuggestionsForProject(item.project); track
        suggestion.properties.sourceBranch) {
        <div class="suggestion-item">
          <div class="suggestion-info">
            <span class="branch-name">{{
              suggestion.properties.sourceBranch.replace("refs/heads/", "")
            }}</span>
          </div>
          <button
            class="create-pr-suggestion-btn"
            (click)="onCreatePR(suggestion, $event)"
            title="Create pull request from {{
              suggestion.properties.sourceBranch.replace('refs/heads/', '')
            }}"
          >
            Create PR
          </button>
        </div>
        }
      </div>
      }
    </div>
    }
  </div>
  <div class="total-count">
    <strong
      >Total: {{ pullRequests.length }} active pull request{{
        pullRequests.length !== 1 ? "s" : ""
      }}</strong
    >
    @if (draftCount > 0) {
    <span class="draft-info">
      ({{ regularCount }} regular{{ regularCount !== 1 ? "s" : "" }},
      {{ draftCount }} draft{{ draftCount !== 1 ? "s" : "" }})
    </span>
    } @if (!showDrafts && draftCount > 0) {
    <span class="current-view"
      >â€¢ {{ draftCount }} draft{{ draftCount !== 1 ? "s" : "" }} hidden</span
    >
    } @if (selectedRepositories.size > 0) {
    <span class="filter-info">
      (Showing {{ filteredPullRequests.length }} from
      {{ selectedRepositories.size }} repo{{
        selectedRepositories.size !== 1 ? "s" : ""
      }}: {{ getSelectedRepositoriesText() }})
      <button (click)="onClearFilter()" class="clear-filter-btn">
        Clear Filter
      </button>
    </span>
    }
  </div>
</div>
}
